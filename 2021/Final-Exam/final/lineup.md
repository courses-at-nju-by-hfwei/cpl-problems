# 列队 (lineup)

## 题目描述

**高能预警：**链表来了。

**提示：**更准确地讲，是指针来了，这已经不是我们课上介绍的单链表、双链表、循环链表，而是更复杂的结构。

不过，万变不离其宗，你掌握其“**宗**” 了吗？

**温馨提示：**不用链表，而用二维数组，也可以得部分分数。

---

有很多小朋友，排成一个 $n$ 行 $m$ 列的方阵。

第 $i$ 行第 $j$ 列的小朋友编号为 $i\cdot m + j$（$i$ 与 $j$ 均从 $1$开始）。

例如，$n=4$，$m=6$ 的初始方阵编号如下：

```
7  8  9  10 11 12
13 14 15 16 17 18
19 20 21 22 23 24
25 26 27 28 29 30
```

我们可以对方阵下达“子方阵交换”指令，

指令格式包含$9$个整数： $x_1, y_1, x_2, y_2, x_3, y_3, x_4, y_4, a$。

其中，

* $x_1, y_1, x_2, y_2$ 表示一个子方阵：$(x_1, y_1)$ 是子方阵的左上角坐标，$(x_2, y_2)$ 是子方阵的右下角坐标
* 类似地，$x_3, y_3, x_4, y_4$ 也表示一个子方阵
* 上述两个子方阵长、宽分别相同，没有公共元素，也没有相邻元素（不允许横、竖相邻，但允许对角相邻）。如下图形示例了合法子方阵与非法子方阵。![IMG_384410B89953-1.jpeg](http://file.tilnel.com//uploads/2022-01-06-IMG_384410B89953-1.jpeg)
* $a$ 表示行号（$1 \le a \le n$）

该指令要求两个子方阵作为整体进行交换，并输出交换后方阵第 $a$ 行的编号之和。

例如，在上面的初始方阵上，执行指令 $ 1, 1, 2, 3, 3, 4, 4, 6, 2$ ，交换两个子方阵后，将得到如下新方阵：

```
22 23 24 10 11 12
28 29 30 16 17 18
19 20 21 7  8  9
25 26 27 13 14 15
```

然后，我们需要输出第二行（$a=2$）的编号之和，即

```
138
```

整个过程如图所示

![IMG_0567FFC3A467-1.jpeg](http://file.tilnel.com//uploads/2022-01-05-IMG_0567FFC3A467-1.jpeg)

## 输入格式

* 第一行：两个整数 $n, m$
* 第二行：一个整数 $q$，表示共会下达 $q$ 次“子方阵交换”指令。
  * **注意，从初始方阵开始，这 $q$ 个指令是连续作用的。**
* 随后 $q$ 行，每行 $ 9$ 个数，代表一条“子方阵交换”指令： $x_1, y_1, x_2, y_2, x_3, y_3, x_4, y_4, a$

## 输出格式

一共 $q$ 行，每行一个数，表示需要计算的相应行中编号之和。

***注意：***这一加和需要使用 `long long` 来表示和输出。

## 脚注

对于 $ 50$ 分的数据，满足 $ 1 \le n, m, q \le 100$

对于 $ 100$ 分的数据，满足 $ 1 \le n, m, q \le 2500$

**注意：**使用二维数组的简单做法，对某些测试用例，可能会超时。

---

下面通过一个例子演示如何使用“链表”解决该问题，其中箭头表示指针（不排除其它的“链表”解决方案）。

在如下方阵（此处的编号仅作示意）中，每个元素有两个指针：一个向右，一个向下。

假设我们交换 $(2,2) \sim (3,3)$ 和 $(3,5) \sim (4,6)$ 两个子方阵：

![prop1.png](http://file.tilnel.com//uploads/2022-01-05-prop1.png)

如果使用二维数组，对于长 $l$ 宽 $w$ 的两个子方阵，要交换 $lw$ 对元素。

如果使用“链表”，则可以切断子方阵四周的指针，将它“裁下来”（从逻辑上理解，不代表具体实现），效果可用如下两幅图表示：

![prop2.png](http://file.tilnel.com//uploads/2022-01-05-prop2.png)

在右图中，虚箭头表示子方阵的左邻侧和上邻侧的“扇入”指针，实箭头表示子方阵自身的右边和下边的“扇出”指针。

对于另一个子方阵，亦是如此：

![prop8.png](http://file.tilnel.com//uploads/2022-01-07-prop8.png)

然后，把两个裁出来的子方阵填入目标位置即可：

![prop7.png](http://file.tilnel.com//uploads/2022-01-07-prop7.png)

所以，如果使用“链表”，只需逐一交换两个子方阵四周的*约* $2 \times (l+w)$ 对指针。

最后，别忘了题目要求输出某行中的编号之和。

## 样例输入

4 6
3
1 1 2 3 3 4 4 6 2
2 3 2 3 3 4 3 4 3
1 1 4 1 1 6 4 6 1

## 样例输出

138
107
102
